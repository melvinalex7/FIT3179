{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "title": "Top 10 Happiest Countries in the World",
  "width": 400,
  "height": 300,
  "params": [
    {
      "name": "year_selection",
      "value": 2015,
      "bind": {
        "input": "range",
        "min": 2015,
        "max": 2019,
        "step": 1,
        "name": "Report Year: "
      }
    },
    {
      "name": "category_selection",
      "value": "Happiness_Score",
      "bind": {
        "input": "select",
        "options": [
          "Happiness_Score",
          "Economy",
          "Family",
          "Health",
          "Freedom",
          "Trust",
          "Generosity"
        ],
        "labels": [
          "Overall",
          "Economy",
          "Family",
          "Health",
          "Freedom",
          "Trust",
          "Generosity"
        ],
        "name": "Category: "
      }
    }

  ],

"data": {
  "url": "https://raw.githubusercontent.com/melvinalex7/FIT3179/main/Assignment_2/data/Happiness_Report_Dataset_Cleaned.csv"
},
"transform": [
  { "filter": "datum.Year == year_selection"},
  {
    "calculate": "datum[category_selection]", "as": "selected_category"
  },
  {
      "window": [{
        "op": "rank",
        "as": "happiness_rank"
      }],
      "sort": [{ "field": "Happiness_Score", "order": "descending" }]
    }, 
    { "filter": "datum.happiness_rank <= 10" }
    
    
],
"encoding": {
      "y": {
          "field": "Country",
          "type": "nominal",
          "sort": {"field": "selected_category", "order":"descending"}
      },
      "x": {
          "field": "selected_category",
          "type": "quantitative",
          "title": "Happiness Score"
      },
      "color":{
        "value": "indigo"
      },
      "tooltip": [
        {"field": "Country", "type": "nominal", "title": "Country"},
        {"field": "selected_category", "type": "quantitative", "title": "Happiness Score", "format": ".4s"}]
    }
  ,
"layer":[
  {
    "mark": "bar"
  }
]

}